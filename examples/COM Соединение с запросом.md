```
КомСоединитель = Новый COMОбъект("V83.ComConnector");

ip = ""; base = ""; user = ""; pswrd = ""; 

Попытка
	Соединение = КомСоединитель.Connect(СтрШаблон("srvr = "%1"; ref = "%2"; usr = "%3"; pwd = "%4""), ip, base, user, pswrd);
Исключение
	Соединение=Неопределено;		
	Возврат "База данных не открыта!!! " + Символы.ПС + ОписаниеОшибки(); 
КонецПопытки;


Попытка
	Запрос   =  Соединение.NewObject("Запрос");
	Запрос.Текст = "
	|ВЫБРАТЬ
	|	Номенклатура.Ссылка								КАК Ссылка,
	|	Номенклатура.Наименование						КАК Наименование,
	|	Номенклатура.Родитель.Наименование				КАК Родитель,
	|	Номенклатура.Длина								КАК ГабДлина,
	|	Номенклатура.Ширина								КАК ГабШирина,
	|	Номенклатура.Толщина							КАК ГабТолщина,
	|	Номенклатура.НоменклатураБазовая.Наименование	КАК Цвет
	|ИЗ
	|	Справочник.Номенклатура КАК Номенклатура
	|ГДЕ
	|	Номенклатура.ЭтоГруппа	= Ложь
	|	И Номенклатура.ВидНоменклатуры.Наименование	= ""Продукция""
	|	И Номенклатура.Ссылка В ИЕРАРХИИ(	ВЫБРАТЬ
	|										Номенклатура.Ссылка
	|									ИЗ
	|										Справочник.Номенклатура КАК Номенклатура
	|									ГДЕ
	|										Номенклатура.Наименование В(""ГП"")
	|										И Номенклатура.ЭтоГруппа = ИСТИНА)";	
	//Запрос.УстановитьПараметр("Т1",Соединение.Перечисления.ТипыКонтактнойИнформации.Телефон);
	//Запрос.Параметры.Вставить("Сырье",Сырье);
	//Номенклатура.Наименование В(""Краситель"",""Регенерат"",""Сырье"")

	Результат	= Запрос.Выполнить();
	Выборка		= Результат.Выбрать();
	Количество	= Выборка.Количество();
	
Исключение
	Соединение=Неопределено;		
	Возврат "Запрос не выполнен!!! " + Символы.ПС + ОписаниеОшибки(); 		
КонецПопытки;

ГруппаГП	= Справочники.Номенклатура.НайтиПоНаименованию("ГП",Истина);
Добавлено	= 0;
НайденоЦветов	= 0;
НеНайденоЦветов	= 0;
НеВошедшиеЦветаМассив	= Новый Массив;

Пока Выборка.Следующий() Цикл
	Попытка
		Цвет	= НайтиЦвет(Выборка.Цвет,НеВошедшиеЦветаМассив);
		Если ЗначениеЗаполнено(Цвет) Тогда
			НайденоЦветов	= НайденоЦветов+1;
			Родитель		= Справочники.Номенклатура.НайтиПоНаименованию(Выборка.Родитель,Истина);
			Если Не ЗначениеЗаполнено(Родитель) Тогда
				Родитель	= ГруппаГП;
			КонецЕсли;
			
			//Справочники.Номенклатура.СоздатьНовуюНоменклатуруГП(Цвет,Выборка.ГабДлина,Выборка.ГабШирина,Выборка.ГабТолщина,Родитель,,"Перенесено из УПП" + Символы.ПС + Выборка.Наименование);
		Иначе
			//Список.Добавить(Выборка.Наименование + " // " + Выборка.Родитель + " // " + "Не найден цвет: " + Выборка.Цвет);
			НеНайденоЦветов	= НеНайденоЦветов+1;	
		КонецЕсли;
		Добавлено	= Добавлено + 1;	
	Исключение
		Список.Добавить(Выборка.Наименование + " // " + Выборка.Родитель + " // " + ОписаниеОшибки());	
	КонецПопытки;		
КонецЦикла;	
			
НеВошедшиеЦветаМассив	= УдалитьПовторяющиесяЭлементыМассива(НеВошедшиеЦветаМассив);
Для Каждого Строка Из НеВошедшиеЦветаМассив Цикл
	Список.Добавить(Строка);	
КонецЦикла;

Попытка
	//КомСоединитель.ЗавершитьРаботуСистемы(Ложь); 
	//КомСоединитель.Terminate(Ложь);
	КомСоединитель	= Неопределено; 		
	Соединение		= Неопределено;
	Соединение		= Ложь;
Исключение
	Возврат "Не удается разорвать подключение." + Символы.ПС + ОписаниеОшибки(); 
КонецПопытки;

Возврат "Найдено цветов: " + НайденоЦветов + Символы.ПС + "Не найдено цветов: " + НеНайденоЦветов;
```